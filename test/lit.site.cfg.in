# -*- Python -*-
# vim: set filetype=python:
# vim: ts=2:sts=2:sw=2:et:tw=80:

################################################################################
#
# @LIT_AUTOGENERATED_WARNING@
#
################################################################################

config.klee_src_root = "@KLEE_SOURCE_DIR@"
config.klee_obj_root = "@KLEE_BINARY_DIR@"
config.klee_tools_dir = "@KLEE_TOOLS_DIR@"
config.llvm_tools_dir = "@LLVM_TOOLS_DIR@"

config.libcxx_include_dir = "@KLEE_LIBCXX_INCLUDE_DIR@"

# Needed to check if a hack needs to be applied
config.llvm_version_major = "@LLVM_VERSION_MAJOR@"
config.llvm_version_minor = "@LLVM_VERSION_MINOR@"

# Compilers
config.clang = "@LLVMCC@"
config.clangxx = "@LLVMCXX@"

config.cc = "@NATIVE_CC@"
config.cxx = "@NATIVE_CXX@"

# NOTE: any changes to compiler flags also have to be applied to
#       test/Concrete/CMakeLists.txt
config.O0opt = "-O0"
if @LLVM_VERSION_MAJOR@ >= 5:
  config.O0opt += " -Xclang -disable-O0-optnone"

# Features
config.enable_uclibc = bool(@SUPPORT_KLEE_UCLIBC@)
config.enable_posix_runtime = bool(@ENABLE_POSIX_RUNTIME@)
config.enable_libcxx = bool(@SUPPORT_KLEE_LIBCXX@)
config.enable_eh_cxx = bool(@SUPPORT_KLEE_EH_CXX@)
config.have_selinux = bool(@HAVE_SELINUX@)
config.enable_stp = bool(@ENABLE_STP@)
config.enable_z3 = bool(@ENABLE_Z3@)
config.enable_zlib = bool(@HAVE_ZLIB_H@)
config.have_asan = bool(@IS_ASAN_BUILD@)
config.have_ubsan = bool(@IS_UBSAN_BUILD@)
config.have_msan = bool(@IS_MSAN_BUILD@)

# Add sanitizer list
config.environment['LSAN_OPTIONS'] = "suppressions=@KLEE_UTILS_DIR@/sanitizers/lsan.txt"
config.environment['UBSAN_OPTIONS'] = "suppressions=@KLEE_UTILS_DIR@/sanitizers/ubsan.txt"

# Current target
config.target_triple = "@TARGET_TRIPLE@"

# Path to libkleeRuntest
config.libkleeruntest = "@LIB_KLEE_RUN_TEST_PATH@"

# Let the main config do the real work.
try:
  lit
except NameError:
  # Use lit_config class
  lit_config.load_config(config, "@KLEE_SOURCE_DIR@/test/lit.cfg")
else:
  # Use old lit class
  lit.load_config(config, "@KLEE_SOURCE_DIR@/test/lit.cfg")
